<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BG Zero - T√°ch n·ªÅn si√™u c·∫•p</title>
  <link rel="stylesheet" href="/static/style.css">
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <style>
    #side-by-side {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    #side-by-side div {
      flex: 1;
      min-width: 300px;
      max-width: 500px;
      text-align: center;
    }
    #side-by-side img {
      width: 100%;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <header>
    <h1>BG Zero</h1>
    <p>X√≥a n·ªÅn ·∫£nh chuy√™n nghi·ªáp, th√¥ng minh</p>
  </header>

  <main>
    <div id="upload-area">
      <form id="uploadForm" method="post" enctype="multipart/form-data">
        <input type="file" name="image" id="imageInput" accept="image/*">
        <label for="imageInput">Ch·ªçn ·∫£nh ƒë·ªÉ t√°ch n·ªÅn</label>
        <div id="preview"></div>
        <button type="submit" id="removeBtn">T√°ch n·ªÅn th√¥ng minh</button>
      </form>
      <div id="loading" style="display:none">üîÑ ƒêang x·ª≠ l√Ω... xin ch·ªù m·ªôt ch√∫t...</div>
    </div>

    <div id="result-area" style="display:none">
      <h2>K·∫øt qu·∫£</h2>
      <div id="side-by-side">
        <div>
          <h3>·∫¢nh g·ªëc</h3>
          <div id="originalImage"></div>
        </div>
        <div>
          <h3>·∫¢nh ƒë√£ t√°ch n·ªÅn</h3>
          <img id="outputImg" src="">
        </div>
      </div>

      <div id="download-options">
        <p>T·∫£i v·ªÅ v·ªõi ƒë·ªô ph√¢n gi·∫£i:</p>
        <button class="res-btn" data-res="360">360p (Mi·ªÖn ph√≠)</button>
        <button class="res-btn" data-res="720">720p (T·∫°m th·ªùi mi·ªÖn ph√≠)</button>
        <button class="res-btn" data-res="1080">1080p (T·∫°m th·ªùi mi·ªÖn ph√≠)</button>
        <button class="res-btn premium" data-res="2k">2K</button>
        <button class="res-btn premium" data-res="4k">4K</button>
      </div>

      <div id="premium-popup" style="display:none">
        <p>ƒê√¢y l√† ch·ª©c nƒÉng Premium. Vui l√≤ng thanh to√°n ƒë·ªÉ t·∫£i v·ªõi ƒë·ªô ph√¢n gi·∫£i cao.</p>
        <button onclick="checkoutPaypal()">Thanh to√°n b·∫±ng PayPal</button>
      </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 BG Zero. Made with ‚ù§Ô∏è in Vietnam. Donate me at.</p>
    <div id="ads">[Qu·∫£ng c√°o s·∫Ω xu·∫•t hi·ªán ·ªü ƒë√¢y]</div>
    <div id="contact">
      <p>üì¨ H·ª£p t√°c qu·∫£ng c√°o: <a href="mailto:bgzero.contact@gmail.com?subject=H·ª£p t√°c qu·∫£ng c√°o&body=Ch√†o BG Zero, t√¥i mu·ªën ƒë·∫∑t qu·∫£ng c√°o tr√™n trang web c·ªßa b·∫°n. Chi ti·∫øt nh∆∞ sau:">bgzero.contact@gmail.com</a></p>
    </div>
  </footer>

  <script>
    const imageInput = document.getElementById('imageInput');
    const preview = document.getElementById('preview');
    const removeBtn = document.getElementById('removeBtn');
    const outputImg = document.getElementById('outputImg');
    const resultArea = document.getElementById('result-area');
    const downloadButtons = document.querySelectorAll('.res-btn');
    const premiumPopup = document.getElementById('premium-popup');
    const uploadForm = document.getElementById('uploadForm');
    const loading = document.getElementById('loading');
    const originalImage = document.getElementById('originalImage');

    let uploadedFile = null;
    imageInput.addEventListener('change', () => {
      const file = imageInput.files[0];
      if (file) {
        uploadedFile = file;
        const reader = new FileReader();
        reader.onload = e => {
          preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
          originalImage.innerHTML = `<img src="${e.target.result}" alt="Original">`;
        }
        reader.readAsDataURL(file);
      }
    });

    uploadForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!uploadedFile) return alert('Vui l√≤ng ch·ªçn ·∫£nh tr∆∞·ªõc.');

      const formData = new FormData();
      formData.append('image', uploadedFile);

      loading.style.display = 'block';
      resultArea.style.display = 'none';

      const res = await fetch('/smart-upload', {
        method: 'POST',
        body: formData
      });

      loading.style.display = 'none';

      if (res.ok) {
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        outputImg.src = url;
        resultArea.style.display = 'block';
        anime({
          targets: '#result-area',
          opacity: [0, 1],
          translateY: [50, 0],
          duration: 800,
          easing: 'easeOutExpo'
        });
      } else {
        alert('·∫¢nh kh√¥ng h·ª£p l·ªá ho·∫∑c qu√° nh·ªè. Vui l√≤ng ch·ªçn ·∫£nh r√µ n√©t, k√≠ch th∆∞·ªõc l·ªõn h∆°n 100x100px.');
      }
    });

    downloadButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const res = btn.getAttribute('data-res');
        if (btn.classList.contains('premium')) {
          premiumPopup.style.display = 'block';
        } else {
          const a = document.createElement('a');
          a.href = outputImg.src;
          a.download = `output_${res}.png`;
          a.click();
        }
      });
    });

    function checkoutPaypal() {
      alert('Ch·ª©c nƒÉng thanh to√°n PayPal s·∫Ω ƒë∆∞·ª£c t√≠ch h·ª£p sau.');
    }
  </script>
</body>
</html>
